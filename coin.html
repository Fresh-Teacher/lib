<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz App</title>
    <link rel="stylesheet" href="path/to/your/bootstrap.css">
</head>
<body>
    <!-- Add your HTML content here -->
    <input type="text" id="playerName" placeholder="Enter your name">
    <select id="topic">
        <option value="">Select a topic</option>
        <option value="physicalQuantitiesandUnits">Physical Quantities and Units</option>
        <option value="kinematics">Kinematics</option>
        <option value="vectorsAndScalars">Vectors and Scalars</option>
        <option value="projectiles">Projectiles</option>
        <option value="newtonsLawsOfMotion">Newton's Laws of Motion</option>
        <option value="linearMomentum">Linear Momentum</option>
        <option value="solidFriction">Solid Friction</option>
        <option value="workEnergyAndPower">Work, Energy, and Power</option>
        <option value="statistics">Statistics</option>
        <option value="cellBiology">Cell Biology</option>
        <option value="genetics">Genetics</option>
    </select>
    <button onclick="startQuiz()">Start Quiz</button>

    <div id="loadingModal" class="modal">
        <div class="modal-content">
            <p id="loadingMessage">Loading...</p>
        </div>
    </div>

    <div id="randomNamePlaceholder"></div>
    <div id="opponentRandomName"></div>

    <script>
        async function startQuiz() {
            console.log('Starting quiz...');
            var playerName = document.getElementById('playerName').value.trim();
            
            if (playerName === '') {
                alert('Please enter your name.');
                return;
            }

            var topic = document.getElementById('topic').value;
            if (topic === '') {
                alert('Please select a topic.');
                return;
            }

            $('#loadingModal').modal('show');

            console.log('Fetching questions for topic:', topic);
            selectedQuestions = await fetchQuestions(topic);

            if (!selectedQuestions) {
                alert('Failed to load questions for the selected topic.');
                $('#loadingModal').modal('hide');
                return;
            }

            console.log('Fetching names...');
            var names = await fetchNames();
            console.log('Fetched names:', names);

            if (!names || names.length === 0) {
                alert('Failed to load names.');
                $('#loadingModal').modal('hide');
                return;
            }

            saveSettings();
            initializeQuiz();
            changeLoadingMessageWithRandomName(names);
        }

        async function fetchQuestions(topic) {
            try {
                const response = await fetch(`${topic}.json`);
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                const data = await response.json();
                console.log('Questions fetched successfully:', data);
                return data;
            } catch (error) {
                console.error('There has been a problem with your fetch operation:', error);
                return null;
            }
        }

        async function fetchNames() {
            try {
                const response = await fetch('names.json');
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                const data = await response.json();
                console.log('Names JSON:', data);
                return data.names;
            } catch (error) {
                console.error('There has been a problem with your fetch operation:', error);
                return [];
            }
        }

        // Shuffle function to shuffle the array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function changeLoadingMessageWithRandomName(names) {
            console.log('Shuffling names...');
            var shuffledNames = shuffleArray(names);

            var randomName = shuffledNames[Math.floor(Math.random() * shuffledNames.length)];
            console.log('Random name selected:', randomName);

            setTimeout(function () {
                changeLoadingMessage('Congratulations! ðŸŽ‰ You are going to play this quiz with ' + randomName);
            }, 5000);

            document.getElementById('randomNamePlaceholder').innerText = randomName;
            document.getElementById('opponentRandomName').innerText = randomName;

            setTimeout(function() {
                $('#loadingModal').modal('hide');
            }, 10000);
        }

        function changeLoadingMessage(message) {
            document.getElementById('loadingMessage').innerText = message;
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Call initialize functions or any setup logic if needed
        });
    </script>
</body>
</html>
