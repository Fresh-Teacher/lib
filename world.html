<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>World Knowledge Quiz</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Schoolbell&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Schoolbell', cursive;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">World Knowledge Quiz</h1>
        <div class="text-center mb-3">
            <label for="playerName">Enter your name:</label>
            <input type="text" id="playerName" class="form-control w-50 mx-auto" placeholder="Your Name">
            <div class="mt-3">
                <label for="quizType">Choose a quiz:</label>
                <select id="quizType" class="form-control w-50 mx-auto">
                    <option value="cities">Cities of the World</option>
                    <option value="countries">Countries in Continents</option>
                    <option value="presidents">Presidents of Countries</option>
                </select>
            </div>
            <button class="btn btn-primary mt-2" onclick="startQuiz()">Start Quiz</button>
        </div>
        <div id="quiz" class="d-none">
            <div id="questionContainer" class="text-center"></div>
            <button id="nextButton" class="btn btn-primary mt-3 d-none" onclick="nextQuestion()">Next Question</button>
        </div>
        <div id="timer" class="text-center mt-3">60:00</div>
        <div id="score" class="text-center mt-3">Score: 0</div>
    </div>

    <script>
        var questions = [];
        var askedQuestions = [];
        var score = 0;
        var currentQuestionIndex = 0;
        var timerInterval;
        var timeLeft = 3600; // 60 minutes in seconds

        async function fetchQuestions(quizType) {
            const response = await fetch(quizType + '.json');
            const data = await response.json();
            return data;
        }

        async function startQuiz() {
            var playerName = document.getElementById('playerName').value.trim();
            var quizType = document.getElementById('quizType').value;

            if (playerName === '') {
                alert('Please enter your name.');
                return;
            }

            questions = await fetchQuestions(quizType);

            document.querySelector('.text-center.mb-3').style.display = 'none';
            document.getElementById('quiz').classList.remove('d-none');
            startTimer();
            loadQuestion();
        }

        function startTimer() {
            var timerDisplay = document.getElementById('timer');
            timerInterval = setInterval(function () {
                var minutes = Math.floor(timeLeft / 60);
                var seconds = timeLeft % 60;
                var formattedTime = ('0' + minutes).slice(-2) + ':' + ('0' + seconds).slice(-2);
                timerDisplay.textContent = formattedTime;

                if (timeLeft === 0) {
                    clearInterval(timerInterval);
                    alert('Time is up! Your score is ' + score);
                } else {
                    timeLeft--;
                }
            }, 1000);
        }

        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) {
                clearInterval(timerInterval);
                alert('Quiz finished! Your score is ' + score);
                return;
            }

            var questionData = questions[currentQuestionIndex];
            var questionContainer = document.getElementById('questionContainer');
            questionContainer.innerHTML = '<h3>' + questionData.question + '</h3>';

            questionData.options.forEach((option, index) => {
                var optionInput = document.createElement('input');
                optionInput.type = 'radio';
                optionInput.name = 'option';
                optionInput.value = option;
                optionInput.id = 'option' + index;

                var optionLabel = document.createElement('label');
                optionLabel.htmlFor = 'option' + index;
                optionLabel.innerText = option;

                questionContainer.appendChild(optionInput);
                questionContainer.appendChild(optionLabel);
                questionContainer.appendChild(document.createElement('br'));
            });

            document.getElementById('nextButton').classList.remove('d-none');
        }

        function nextQuestion() {
            var selectedOption = document.querySelector('input[name="option"]:checked');
            if (selectedOption) {
                var answer = selectedOption.value;
                if (answer === questions[currentQuestionIndex].answer) {
                    score++;
                    document.getElementById('score').textContent = 'Score: ' + score;
                }
                currentQuestionIndex++;
                loadQuestion();
            } else {
                alert('Please select an answer.');
            }
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
